<!-- Critical Layout Override - Must Load After TailwindCSS -->
<style id="webinar-layout-override">
  /* WEBINAR ROOM LAYOUT - COMPLETE REWRITE */
  
  /* Force body reset when on webinar room page */
  body:has(.webinar-room-container) {
    margin: 0 !important;
    padding: 0 !important;
    overflow: hidden !important;
  }
  
  /* Container Setup */
  .webinar-room-container {
    width: 100vw !important;
    height: 100vh !important;
    display: flex !important;
    flex-direction: column !important;
    margin: 0 !important;
    padding: 0 !important;
    overflow: hidden !important;
    background: linear-gradient(135deg, #1a1a2e, #0f1419) !important;
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    z-index: 9999 !important;
  }
  
  .webinar-room-content {
    flex: 1 !important;
    display: flex !important;
    flex-direction: column !important;
    overflow: hidden !important;
    width: 100% !important;
    height: 100% !important;
  }
  
  /* Main Content Layout - DESKTOP ONLY */
  .main-content {
    flex: 1 !important;
    display: flex !important;
    flex-direction: row !important; /* CRITICAL: Row = side by side */
    width: 100% !important;
    height: calc(100vh - 60px) !important;
    overflow: hidden !important;
    position: relative !important;
  }
  
  /* Video Area - LEFT SIDE ALWAYS */
  .video-area {
    width: 70% !important;
    height: 100% !important;
    background: #000 !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    order: 1 !important; /* FORCE LEFT POSITION */
    position: relative !important;
    min-width: 500px !important;
  }
  
  /* Video Element Visibility */
  .video-area video,
  .video-area iframe,
  .video-area .video-player {
    width: 100% !important;
    height: 100% !important;
    object-fit: contain !important;
    display: block !important;
    visibility: visible !important;
    z-index: 10 !important;
  }
  
  /* Chat Panel - RIGHT SIDE ALWAYS */
  .chat-panel {
    width: 30% !important;
    height: 100% !important;
    background: rgba(23, 25, 35, 0.95) !important;
    border-left: 2px solid #3b82f6 !important;
    display: flex !important;
    flex-direction: column !important;
    order: 2 !important; /* FORCE RIGHT POSITION */
    position: relative !important;
    min-width: 300px !important;
  }
  
  /* VIDEO AREA - Left Side, Takes Remaining Space */
  .webinar-room-container .video-area,
  .video-area {
    flex: 1 !important;
    display: flex !important;
    flex-direction: column !important;
    background: #000 !important;
    position: relative !important;
    order: 1 !important;
    min-width: 320px !important;
    min-height: 240px !important;
    overflow: hidden !important;
  }
  
  .video-area-redesigned {
    flex: 1 !important;
    display: flex !important;
    flex-direction: column !important;
    width: 100% !important;
    height: 100% !important;
    background: #1a1a1a !important;
    border: 1px solid #333 !important;
  }
  
  .video-content {
    flex: 1 !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    background: #000 !important;
    width: 100% !important;
    min-height: 200px !important;
  }
  
  #webinarVideo {
    width: 100% !important;
    height: 100% !important;
    object-fit: contain !important;
    background: #000 !important;
    display: block !important;
  }
  
  /* CHAT PANEL - Right Side, Fixed Width */
  .webinar-room-container .chat-panel,
  .chat-panel {
    width: 350px !important;
    flex-shrink: 0 !important;
    display: flex !important;
    flex-direction: column !important;
    background: linear-gradient(180deg, #2a2d3a, #1e2029) !important;
    border-left: 2px solid #3a3f4f !important;
    box-shadow: -4px 0 15px rgba(0, 0, 0, 0.3) !important;
    order: 2 !important;
    overflow: hidden !important;
  }
  
  /* CONTROL PANEL - Bottom of Everything */
  .control-panel-redesign {
    width: 100% !important;
    height: 60px !important;
    flex-shrink: 0 !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    gap: 12px !important;
    background: rgba(30, 30, 30, 0.95) !important;
    backdrop-filter: blur(20px) !important;
    border-top: 1px solid rgba(255, 255, 255, 0.08) !important;
    padding: 12px 20px !important;
    order: 3 !important;
  }
  
  /* Hide when chat is hidden */
  .chat-panel.hidden {
    display: none !important;
  }
  
  /* MOBILE PORTRAIT */
  @media screen and (max-width: 768px) and (orientation: portrait) {
    .main-content {
      flex-direction: column !important;
      height: calc(100vh - 60px) !important;
    }
    
    .video-area {
      order: 1 !important;
      height: 65vh !important;
      flex: none !important;
      width: 100% !important;
    }
    
    .chat-panel {
      order: 2 !important;
      width: 100% !important;
      height: calc(35vh - 60px) !important;
      flex: none !important;
      border-left: none !important;
      border-top: 2px solid #3a3f4f !important;
    }
  }
  
  /* MOBILE LANDSCAPE */
  @media screen and (max-width: 768px) and (orientation: landscape) {
    .main-content {
      flex-direction: row !important;
      height: calc(100vh - 50px) !important;
    }
    
    .video-area {
      order: 1 !important;
      width: 75% !important;
      flex: none !important;
    }
    
    .chat-panel {
      order: 2 !important;
      width: 25% !important;
      flex: none !important;
      border-left: 2px solid #3a3f4f !important;
    }
    
    .control-panel-redesign {
      height: 50px !important;
    }
  }
  
  /* DESKTOP LAYOUT FORCE - FINAL OVERRIDE */
  @media (min-width: 768px) {
    .webinar-room-container .main-content,
    .main-content {
      display: flex !important;
      flex-direction: row !important;
      width: 100% !important;
      height: calc(100vh - 120px) !important;
      min-height: 400px !important;
      flex: 1 !important;
      overflow: hidden !important;
    }
    
    /* VIDEO MUST BE LEFT */
    .webinar-room-container .video-area,
    .video-area,
    .video-area-redesigned {
      order: 1 !important;
      width: 70% !important;
      height: 100% !important;
      min-height: 400px !important;
      flex: 1 !important;
      min-width: 500px !important;
      background: #000 !important;
      position: relative !important;
      display: flex !important;
      align-items: center !important;
      justify-content: center !important;
    }
    
    /* CHAT MUST BE RIGHT */
    .webinar-room-container .chat-panel,
    .chat-panel {
      order: 2 !important;
      width: 30% !important;
      height: 100% !important;
      min-height: 400px !important;
      min-width: 300px !important;
      max-width: 350px !important;
      flex-shrink: 0 !important;
      background: #1e2029 !important;
      border-left: 2px solid #3a3f4f !important;
      position: relative !important;
      display: flex !important;
      flex-direction: column !important;
    }
    
    /* VIDEO ELEMENTS VISIBILITY */
    .video-area video,
    .video-area iframe,
    .video-content video,
    .video-content iframe,
    #webinarVideo {
      display: block !important;
      visibility: visible !important;
      width: 100% !important;
      height: 100% !important;
      object-fit: contain !important;
      background: #000 !important;
    }
  }
</style>

<!-- Webinar Room Page -->
<div class="webinar-room-container">
  <!-- Loading State -->
  <div ng-if="isLoading" class="flex items-center justify-center min-h-screen">
    <div class="text-center">
      <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-primary-500 mx-auto mb-4"></div>
      <p class="text-slate-300">Loading webinar room...</p>
    </div>
  </div>

  <!-- Webinar Room Content -->
  <div ng-if="!isLoading" class="webinar-room-content">

    <!-- SIMPLIFIED MAIN LAYOUT - CLEAN STRUCTURE -->
    <div style="display: flex; flex-direction: row; width: 100%; height: calc(100vh - 120px); min-height: 400px; overflow: hidden; background: #000;">
      
      <!-- VIDEO SECTION - LEFT SIDE (70%) -->
      <div style="order: 1; width: 70%; height: 100%; background: #000; display: flex; align-items: center; justify-content: center; position: relative;">
        
        <!-- Waiting State -->
        <div ng-if="roomState.status === 'waiting'" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center; color: white;">
          <i class="fas fa-clock" style="font-size: 4rem; color: #3b82f6; margin-bottom: 1rem;"></i>
          <h2 style="font-size: 2rem; font-weight: bold; margin-bottom: 0.5rem;">Webinar Starts Soon</h2>
          <p style="color: #cbd5e1; margin-bottom: 1rem;">{{webinar.title}}</p>
          <div style="background: #1e293b; border-radius: 0.5rem; padding: 1.5rem; max-width: 24rem; margin: 0 auto;">
            <div style="font-size: 3rem; font-family: monospace; margin-bottom: 0.5rem;">{{formatTimeToStart()}}</div>
            <p style="color: #94a3b8; font-size: 0.875rem;">Time remaining</p>
          </div>
        </div>
        
        <!-- Video Player -->
        <video ng-if="currentWebinar.videoUrl && !isYouTubeVideo(currentWebinar.videoUrl)" 
               ng-src="{{currentWebinar.videoUrl}}" 
               controls 
               style="width: 100%; height: 100%; object-fit: contain; display: block; visibility: visible;">
        </video>
        
        <iframe ng-if="currentWebinar.videoUrl && isYouTubeVideo(currentWebinar.videoUrl)"
                ng-src="{{getYouTubeEmbedUrl(currentWebinar.videoUrl)}}"
                style="width: 100%; height: 100%; display: block; visibility: visible; border: none;"
                allowfullscreen>
        </iframe>
        
        <!-- No Video State -->
        <div ng-if="!currentWebinar.videoUrl" style="color: white; text-align: center;">
          <i class="fas fa-video" style="font-size: 6rem; color: #6b7280; margin-bottom: 1rem;"></i>
          <p style="font-size: 1.125rem; color: #d1d5db;">Webinar will start soon...</p>
        </div>
        
      </div>
      
      <!-- CHAT SECTION - RIGHT SIDE (30%) -->
      <div style="order: 2; width: 30%; height: 100%; background: #1e2029; border-left: 2px solid #3a3f4f; display: flex; flex-direction: column; min-width: 300px;">
        
        <!-- Chat Header -->
        <div style="padding: 1rem; border-bottom: 1px solid #374151; background: #111827;">
          <h3 style="font-size: 1.125rem; font-weight: 600; color: white; margin: 0;">Live Chat</h3>
          <p style="font-size: 0.875rem; color: #9ca3af; margin: 0.25rem 0 0 0;">{{attendeeCount}} participants online</p>
        </div>
        
        <!-- Chat Messages -->
        <div style="flex: 1; padding: 1rem; overflow-y: auto; background: #1e2029;">
          <div ng-repeat="message in chatMessages" style="margin-bottom: 0.75rem;">
            <div style="display: flex; align-items: flex-start; gap: 0.5rem;">
              <div style="width: 2rem; height: 2rem; background: #3b82f6; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 0.875rem; font-weight: bold; flex-shrink: 0;">
                {{message.username ? message.username.charAt(0).toUpperCase() : 'A'}}
              </div>
              <div style="flex: 1;">
                <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.25rem;">
                  <span style="font-size: 0.875rem; font-weight: 500; color: white;">{{message.username || 'Anonymous'}}</span>
                  <span style="font-size: 0.75rem; color: #9ca3af;">{{formatTime(message.timestamp)}}</span>
                </div>
                <p style="font-size: 0.875rem; color: #d1d5db; margin: 0;">{{message.text}}</p>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Chat Input -->
        <div style="padding: 1rem; border-top: 1px solid #374151; background: #111827;">
          <div style="display: flex; gap: 0.5rem;">
            <input type="text" 
                   ng-model="newMessage" 
                   ng-keyup="$event.keyCode == 13 && sendMessage()"
                   placeholder="Type your message..." 
                   style="flex: 1; padding: 0.5rem 0.75rem; background: #374151; color: white; border-radius: 0.5rem; border: 1px solid #4b5563; outline: none;">
            <button ng-click="sendMessage()" 
                    style="padding: 0.5rem 1rem; background: #2563eb; color: white; border-radius: 0.5rem; border: none; cursor: pointer;">
              <i class="fas fa-paper-plane"></i>
            </button>
          </div>
        </div>
        
      </div>
    </div>

    <!-- Control Panel - BOTTOM, Full Width -->
        <div ng-if="roomState.status === 'live' || roomState.status === 'ended' || roomState.status === 'waiting' || roomState.status === 'loading'" class="video-area-redesigned" style="
          width: 100%;
          height: 100%;
          min-height: 400px;
          background: #1a1a1a;
          display: flex;
          flex-direction: column;
          position: relative;
          border: 1px solid #333;
        ">
          <div class="video-header" style="
            padding: 10px;
            background: #2a2a2a;
            color: #ccc;
            font-size: 12px;
            border-bottom: 1px solid #444;
          ">
            Status: {{roomState.status}} | Video: {{isVideoLoaded ? 'Loaded' : 'Loading'}} | Error: {{videoError}}
          </div>
          
          <div class="video-content" style="
            flex: 1;
            position: relative;
            background: #000;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 300px;
          ">
            <video 
              id="webinarVideo" 
              controls
              preload="metadata"
              src="/uploads/videos/5ab341c5-883f-4a20-ba5d-bfe884742d31_1756137634769_Criteria_Based_Enrollment_in_SORA.mp4"
              style="
                width: 100%;
                height: 100%;
                max-width: 100%;
                max-height: 100%;
                object-fit: contain;
                background: #000;
                display: block;
              "
              onerror="angular.element(this).scope().onVideoError()"
              onloadeddata="angular.element(this).scope().onVideoLoad()">
              <div style="color: white; text-align: center; padding: 20px;">
                Your browser does not support the video tag.
              </div>
            </video>
            
            <!-- Loading indicator when video is not loaded -->
            <div ng-if="!isVideoLoaded && !videoError" style="
              position: absolute;
              top: 50%;
              left: 50%;
              transform: translate(-50%, -50%);
              color: white;
              text-align: center;
            ">
              <div style="
                width: 40px;
                height: 40px;
                border: 3px solid #333;
                border-top: 3px solid #0078d4;
                border-radius: 50%;
                animation: spin 1s linear infinite;
                margin: 0 auto 10px;
              "></div>
              <p>Loading video...</p>
            </div>
            
            <!-- Error indicator -->
            <div ng-if="videoError" style="
              position: absolute;
              top: 50%;
              left: 50%;
              transform: translate(-50%, -50%);
              color: #ff6b6b;
              text-align: center;
            ">
              <i class="fas fa-exclamation-triangle" style="font-size: 32px; margin-bottom: 10px;"></i>
              <p>Video loading failed</p>
              <button onclick="document.getElementById('webinarVideo').load()" style="
                background: #0078d4;
                color: white;
                border: none;
                padding: 8px 16px;
                border-radius: 4px;
                cursor: pointer;
                margin-top: 10px;
              ">Retry</button>
            </div>
          </div>
        </div>
        
        <!-- Live Video - SIMPLIFIED AND CLEAN -->
        <div ng-if="roomState.status === 'live' || roomState.status === 'ended'" class="flex-1 relative">
          <!-- Video will be shown in the redesigned container above -->
        </div>
          
          <!-- Resume Overlay (shows after refresh) -->
          <div ng-if="showResumeButton" class="resume-overlay">
            <button ng-click="resumeVideo()" class="resume-btn bg-primary-600 hover:bg-primary-700 text-white px-8 py-4 rounded-full flex items-center space-x-3 text-xl font-semibold shadow-lg transition-all transform hover:scale-105">
              <i class="fas fa-play text-2xl"></i>
            </button>
          </div>
          
          <!-- Video Controls Overlay (Host Only) -->
          <div ng-if="isVideoLoaded && isHost" class="absolute bottom-4 left-4 flex space-x-2 video-controls">
            <button ng-click="playVideo()" 
                    class="control-button">
              <i class="fas fa-play"></i>
            </button>
            <button ng-click="pauseVideo()" 
                    class="control-button">
              <i class="fas fa-pause"></i>
            </button>
          </div>
          
        </div>
        
        <!-- Ended State -->
        <div ng-if="roomState.status === 'ended'" class="absolute inset-0 bg-black bg-opacity-75 flex items-center justify-center">
          <div class="text-center text-white">
            <i class="fas fa-check-circle text-4xl text-green-500 mb-4"></i>
            <h2 class="text-2xl font-bold mb-2">Webinar Ended</h2>
            <p class="text-slate-300 mb-4">Thank you for attending!</p>
            <button ng-click="leaveRoom()" 
                    class="px-6 py-2 bg-primary-600 hover:bg-primary-700 text-white rounded-lg transition-colors">
              Exit Room
            </button>
          </div>
        </div>
        
      </div>

      <!-- Chat Panel - RIGHT SIDE -->
      <div class="chat-panel" ng-class="{'hidden': chatHidden}">
        
        <!-- Chat Header -->
        <div class="p-4 border-b border-slate-700">
          <h3 class="font-semibold text-white">Chat</h3>
          <p class="text-sm text-slate-400">{{chatMessages.length}} messages</p>
        </div>
        
        <!-- Chat Messages -->
        <div id="chatContainer" class="flex-1 overflow-y-auto p-4 space-y-3 chat-messages">
          <div ng-repeat="message in chatMessages" class="animate-fade-in">
            
            <!-- System Message -->
            <div ng-if="message.isSystem" class="text-center">
              <div class="bg-slate-700 text-slate-300 text-sm px-3 py-2 rounded-lg inline-block">
                {{message.message}}
              </div>
            </div>
            
            <!-- User Message -->
            <div ng-if="!message.isSystem" class="bg-slate-700 rounded-lg p-3">
              <div class="flex items-start space-x-2">
                <div class="w-8 h-8 bg-primary-600 rounded-full flex items-center justify-center flex-shrink-0">
                  <span class="text-white text-xs font-bold">{{message.sender.charAt(0)}}</span>
                </div>
                <div class="flex-1 min-w-0">
                  <div class="flex items-center space-x-2 mb-1">
                    <span class="font-medium text-white text-sm">{{message.sender}}</span>
                    <span class="text-slate-400 text-xs">{{message.timestamp | date:'HH:mm'}}</span>
                  </div>
                  <p class="text-slate-300 text-sm break-words">{{message.message}}</p>
                </div>
              </div>
            </div>
            
          </div>
        </div>
        
        <!-- Chat Input -->
        <div ng-if="isWebinarLive" class="p-4 border-t border-slate-700 chat-input">
          <!-- To Host Indicator -->
      
          <div class="flex space-x-2">
            <input type="text" 
                   ng-model="chat.newMessage" 
                   ng-keypress="$event.keyCode == 13 && sendMessage()"
                   placeholder="Type a private message to Host..."
                   class="flex-1 px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white placeholder-slate-400 focus:ring-2 focus:ring-primary-500 focus:border-transparent text-sm">
            <button ng-click="sendMessage()" 
                    ng-disabled="!chat.newMessage || chat.newMessage.trim() === ''"
                    class="px-4 py-2 bg-primary-600 hover:bg-primary-700 disabled:bg-slate-600 text-white rounded-lg transition-colors min-w-[44px] flex items-center justify-center text-sm font-bold">
              <i class="fas fa-paper-plane"></i>
              <span class="ml-1 hidden sm:inline landscape-hidden">Send</span>
            </button>
          </div>
        </div>
        
        <!-- Chat Disabled Message -->
        <div ng-if="!isWebinarLive" class="p-4 border-t border-slate-700">
          <p class="text-slate-400 text-sm text-center">
            Chat will be available when the webinar starts
          </p>
        </div>
        
      </div>
      
    </div>
    
    <!-- Control Panel - BOTTOM, Full Width -->
    <div class="control-panel-redesign">
      <span class="live-badge">● LIVE</span>
      
      <button ng-click="!micEnabled || toggleMicrophone()" 
              class="ctrl-btn" 
              ng-class="{'muted': !micEnabled}"
              ng-disabled="!micEnabled">
        <i class="fas" ng-class="{'fa-microphone': micEnabled, 'fa-microphone-slash': !micEnabled}"></i>
      </button>
      
      <button ng-click="!videoEnabled || toggleVideo()" 
              class="ctrl-btn" 
              ng-class="{'off': !videoEnabled}"
              ng-disabled="!videoEnabled">
        <i class="fas" ng-class="{'fa-video': videoEnabled, 'fa-video-slash': !videoEnabled}"></i>
      </button>
      
      <button class="ctrl-btn chat-btn" 
              ng-class="{'active': !chatHidden}"
              ng-click="toggleChat()">
        <i class="fas fa-comment"></i>
      </button>
      
      <button ng-click="leaveRoom()" class="ctrl-btn leave-btn">
        <i class="fas fa-phone-slash"></i>
      </button>
      
      <span class="participant-count">
        <i class="fa fa-users"></i> {{attendeeCount || 1}}
      </span>
    </div>
    
  </div>
  
</div>

<!-- Host Control Panel (only for hosts) -->
<div ng-if="isHost" ng-include="'/views/components/host-control-panel.html'"></div>

<!-- Hide main navigation for webinar room -->
<style>
  /* Critical CSS Reset for Webinar Room - Override ALL external frameworks */
  .webinar-room-container,
  .webinar-room-container * {
    box-sizing: border-box !important;
  }
  
  /* Hide main site navigation on webinar room page */
  body nav {
    display: none !important;
  }
  
  /* OVERRIDE TAILWIND CSS COMPLETELY FOR WEBINAR ROOM */
  .webinar-room-container .main-content,
  .webinar-room-container .main-content.flex,
  .webinar-room-container .main-content.flex-1,
  .webinar-room-container .main-content.overflow-hidden {
    display: flex !important;
    flex-direction: row !important; /* Desktop default: side-by-side */
    flex: 1 !important;
    overflow: hidden !important;
    position: relative !important;
    width: 100% !important;
    height: 100% !important;
    min-height: 0 !important;
    max-height: none !important;
    margin: 0 !important;
    padding: 0 !important;
  }
  
  .webinar-room-container .video-area,
  .webinar-room-container .video-area.flex-1,
  .webinar-room-container .video-area.flex,
  .webinar-room-container .video-area.flex-col,
  .webinar-room-container .video-area.bg-black,
  .webinar-room-container .video-area.desktop-video-container {
    display: flex !important;
    flex-direction: column !important;
    flex: 1 !important;
    background: #000 !important;
    position: relative !important;
    border-radius: 0 !important;
    min-width: 0 !important;
    min-height: 0 !important;
    max-height: none !important;
    width: auto !important;
    height: 100% !important;
    margin: 0 !important;
    padding: 0 !important;
  }
  
  .webinar-room-container .chat-panel {
    display: flex !important;
    flex-direction: column !important;
    width: 350px !important;
    flex-shrink: 0 !important;
    background: linear-gradient(180deg, #2a2d3a, #1e2029) !important;
    border-left: 2px solid #3a3f4f !important;
    box-shadow: -4px 0 15px rgba(0, 0, 0, 0.3) !important;
    min-height: 0 !important;
    max-height: none !important;
    height: 100% !important;
    margin: 0 !important;
    padding: 0 !important;
  }
  
  /* Mobile specific body/html reset */
  @media screen and (max-width: 768px) {
    html, body {
      margin: 0 !important;
      padding: 0 !important;
      height: 100vh !important;
      overflow: hidden !important;
    }
    
    /* Reset margins for video area and its children */
    .video-area,
    .video-area *,
    .video-area .flex-1,
    .video-area .text-center,
    .video-area .mb-6,
    .video-area .mb-4,
    .video-area .mb-2,
    .video-area .mt-6,
    .video-area h2,
    .video-area h3,
    .video-area p,
    .video-area div {
      margin: 0 !important;
    }
  }
  
  /* Zoom-like professional webinar interface */
  .webinar-room-container {
    min-height: 100vh;
    background: linear-gradient(135deg, #1a1a2e, #0f1419);
    margin: 0;
    padding: 0;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    position: relative;
    overflow: hidden;
  }
  
  .webinar-room-content {
    height: 100vh;
    display: flex;
    flex-direction: column;
    overflow: hidden; /* Prevent any overflow that might break layout */
    position: relative;
  }
  
  .main-content {
    flex: 1 !important;
    display: flex !important;
    overflow: hidden !important;
    position: relative !important;
    flex-direction: row !important; /* Default desktop: side-by-side */
    min-height: 0 !important; /* Allow flex items to shrink */
    /* Override any external framework styles */
    width: 100% !important;
    height: 100% !important;
  }
  
  .video-area {
    flex: 1 !important;
    display: flex !important;
    flex-direction: column !important;
    background: #000 !important;
    position: relative !important;
    border-radius: 0 !important;
    min-width: 0 !important; /* Allow flexbox shrinking */
    min-height: 0 !important; /* Allow flex items to shrink */
    /* Override any external framework styles */
    box-sizing: border-box !important;
  }
  
  .chat-panel {
    width: 350px !important;
    background: linear-gradient(180deg, #2a2d3a, #1e2029) !important;
    border-left: 2px solid #3a3f4f !important;
    display: flex !important;
    flex-direction: column !important;
    box-shadow: -4px 0 15px rgba(0, 0, 0, 0.3) !important;
    flex-shrink: 0 !important; /* Prevent chat panel from shrinking */
    min-height: 0 !important; /* Allow flex items to shrink */
    /* Override any external framework styles */
    box-sizing: border-box !important;
  }
  
  .chat-panel.hidden {
    display: none !important;
  }
  
  /* Force proper layout structure */
  .webinar-room-container * {
    box-sizing: border-box;
  }
  
  /* Prevent any TailwindCSS or other framework conflicts */
  .main-content.flex {
    display: flex !important;
  }
  
  .main-content.flex-1 {
    flex: 1 !important;
  }
  
  .main-content.overflow-hidden {
    overflow: hidden !important;
  }
  
  /* Override mobile-stack class from main.css on webinar room */
  .webinar-room-container .mobile-stack {
    flex-direction: row !important;
  }
  
  /* Ensure no external CSS overrides critical layout */
  .webinar-room-container .main-content {
    flex-direction: row !important;
  }
  
  /* Desktop layout - OVERRIDE ALL FRAMEWORKS */
  @media screen and (min-width: 769px) {
    .webinar-room-container .main-content,
    .webinar-room-container .main-content.flex,
    .webinar-room-container .main-content.flex-1,
    .webinar-room-container .main-content.overflow-hidden {
      flex-direction: row !important;
      height: calc(100vh - 60px) !important;
      display: flex !important;
    }
    
    .webinar-room-container .video-area,
    .webinar-room-container .video-area.flex-1,
    .webinar-room-container .video-area.flex,
    .webinar-room-container .video-area.flex-col,
    .webinar-room-container .video-area.bg-black {
      flex: 1 !important;
      min-width: 0 !important;
      height: 100% !important;
      display: flex !important;
      flex-direction: column !important;
    }
    
    .webinar-room-container .chat-panel {
      width: 350px !important;
      flex-shrink: 0 !important;
      height: 100% !important;
      display: flex !important;
      flex-direction: column !important;
    }
    
    .webinar-room-container .control-panel-redesign {
      position: relative !important;
      width: 100% !important;
      height: 60px !important;
      bottom: auto !important;
      left: auto !important;
      right: auto !important;
    }
    
    /* When chat is hidden on desktop, video takes full width */
    .webinar-room-container .main-content.chat-hidden .video-area {
      width: 100% !important;
    }
  }
  
  /* Redesigned Control Panel - Below Video */
  .control-panel-redesign {
    position: relative;
    width: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 12px;
    background: rgba(30, 30, 30, 0.95);
    padding: 12px 20px;
    border-radius: 0;
    backdrop-filter: blur(20px);
    border-top: 1px solid rgba(255, 255, 255, 0.08);
    box-shadow: 0 -4px 12px rgba(0, 0, 0, 0.2);
    z-index: 1000;
    flex-wrap: wrap;
    margin-top: auto;
    flex-shrink: 0; /* Prevent control panel from shrinking */
  }

  .info-group {
    display: flex;
    align-items: center;
    gap: 12px;
    flex: 1;
  }

  .live-badge {
    color: #ff4444;
    font-size: 12px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    padding: 2px 6px;
    border-radius: 3px;
    border: 1px solid #ff4444;
    animation: live-blink 1.5s infinite;
  }
  
  @keyframes live-blink {
    0%, 50% { 
      border-color: #ff4444;
      box-shadow: 0 0 0 rgba(255, 68, 68, 0.4);
    }
    100% { 
      border-color: #ff8888;
      box-shadow: 0 0 8px rgba(255, 68, 68, 0.8);
    }
  }

  .webinar-info {
    color: #e2e8f0;
    font-size: 13px;
    font-weight: 500;
    max-width: 200px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }

  .main-controls {
    display: flex;
    gap: 8px;
    align-items: center;
    justify-content: center;
    flex: 0 0 auto;
  }

  .ctrl-btn {
    width: 44px;
    height: 44px;
    border-radius: 50%;
    border: none;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.2s ease;
    font-size: 16px;
    background: #404040;
    color: white;
    position: relative;
  }

  .ctrl-btn:hover {
    background: #505050;
    transform: translateY(-1px);
  }
  
  /* Prevent icon display issues on hover */
  .ctrl-btn i {
    display: inline-block !important;
    width: 16px !important;
    text-align: center !important;
    transition: none !important; /* Disable transitions on icons */
  }
  
  .ctrl-btn:hover i {
    transform: none !important; /* Prevent icon transforms */
  }

  .ctrl-btn.muted, .ctrl-btn.off {
    background: #dc3545;
  }

  .ctrl-btn.active {
    background: #0078d4;
  }

  .ctrl-btn.leave-btn {
    background: #dc3545;
  }

  .ctrl-btn.leave-btn:hover {
    background: #c82333;
  }

  .action-group {
    display: flex;
    align-items: center;
    gap: 12px;
    flex: 1;
    justify-content: flex-end;
  }

  .participant-count {
    color: #e2e8f0;
    font-size: 16px;
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 6px;
    background: rgba(255, 255, 255, 0.1);
    padding: 8px 14px;
    border-radius: 20px;
    border: 2px solid rgba(255, 255, 255, 0.2);
    backdrop-filter: blur(4px);
    min-width: 70px;
    justify-content: center;
  }
  
  /* Resume overlay */
  .resume-overlay {
    z-index: 1000;
    backdrop-filter: blur(5px);
    position: absolute !important;
    top: 0 !important;
    left: 0 !important;
    right: 0 !important;
    bottom: 0 !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
  }
  
  .resume-btn {
    background: linear-gradient(135deg, #3b82f6, #1d4ed8);
    box-shadow: 0 10px 25px rgba(59, 130, 246, 0.3);
    backdrop-filter: blur(10px);
    border: 2px solid rgba(255, 255, 255, 0.1);
    margin: 0 auto !important;
    position: relative !important;
    transform: none !important;
  }
  
  .resume-btn:hover {
    box-shadow: 0 15px 35px rgba(59, 130, 246, 0.4);
    background: linear-gradient(135deg, #2563eb, #1e40af);
  }
  
  /* Single bottom control panel */
  .bottom-control-panel {
    position: absolute;
    bottom: 20px;
    left: 20px;
    right: 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    background: rgba(0, 0, 0, 0.85);
    padding: 15px 20px;
    border-radius: 15px;
    backdrop-filter: blur(15px);
    border: 1px solid rgba(255, 255, 255, 0.1);
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
    z-index: 1000;
  }

  .status-left {
    display: flex;
    align-items: center;
    gap: 15px;
    color: white;
    font-size: 14px;
  }

  .live-indicator {
    display: flex;
    align-items: center;
    gap: 2px;
    color: #ffffff;
    font-weight: 400;
    font-size: 10px;
    background: #ef4444;
    padding: 2px 4px;
    border-radius: 2px;
    text-transform: uppercase;
  }

  .live-dot {
    color: #ffffff;
    font-size: 4px;
    animation: live-pulse 3s infinite ease-in-out;
  }

  .participant-info {
    color: #e2e8f0;
    font-size: 12px;
    display: flex;
    align-items: center;
    gap: 3px;
    padding: 6px 8px;
    background: rgba(255, 255, 255, 0.08);
    border-radius: 15px;
    font-weight: 500;
    margin-left: 8px;
  }

  .control-buttons-center {
    display: flex;
    gap: 12px;
    align-items: center;
  }

  .status-right {
    display: flex;
    align-items: center;
    color: white;
    font-size: 14px;
  }

  .webinar-title {
    font-weight: 600;
    max-width: 200px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }
  
  .control-button {
    width: 45px;
    height: 45px;
    border-radius: 50%;
    border: none;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.3s ease;
    font-size: 16px;
  }
  
  .control-button:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
  }
  
  .control-button.microphone { background: #4a90e2; color: white; }
  .control-button.microphone.muted { background: #e74c3c; }
  .control-button.microphone.disabled { 
    background: #6c757d; 
    cursor: not-allowed; 
    opacity: 0.7;
  }
  .control-button.camera { background: #4a90e2; color: white; }
  .control-button.camera.off { background: #e74c3c; }
  .control-button.camera.disabled { 
    background: #6c757d; 
    cursor: not-allowed; 
    opacity: 0.7;
  }
  .control-button.leave { background: #e74c3c; color: white; }
  .control-button.chat { background: #34495e; color: white; }
  .control-button.chat.active { background: #3498db; color: white; }
  
  /* Enhanced participant info */
  .participant-info {
    position: absolute;
    top: 20px;
    left: 20px;
    background: rgba(0, 0, 0, 0.7);
    padding: 10px 15px;
    border-radius: 10px;
    color: white;
    font-size: 14px;
    backdrop-filter: blur(5px);
  }
  
  /* Enhanced status indicators */
  .status-indicator {
    position: absolute;
    top: 20px;
    right: 20px;
    display: flex;
    gap: 10px;
  }
  
  .status-badge {
    padding: 6px 12px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }
  
  .status-badge.live {
    background: linear-gradient(45deg, #e74c3c, #c0392b);
    color: white;
    animation: pulse 2s infinite;
  }
  
  .status-badge.waiting {
    background: linear-gradient(45deg, #f39c12, #e67e22);
    color: white;
  }
  
  .status-badge.ended {
    background: linear-gradient(45deg, #7f8c8d, #95a5a6);
    color: white;
  }
  
  /* Mobile Portrait overrides - OVERRIDE ALL FRAMEWORKS */
  @media screen and (max-width: 768px) and (orientation: portrait) {
    .webinar-room-container,
    .webinar-room-container.webinar-room-container {
      height: 100vh !important;
      width: 100vw !important; /* Ensure full viewport width */
      min-height: 100vh !important;
      min-width: 100vw !important;
      overflow: hidden !important;
      margin: 0 !important;
      padding: 0 !important;
      box-sizing: border-box !important;
    }
    
    .webinar-room-container .webinar-room-content {
      height: 100vh !important;
      width: 100vw !important; /* Ensure full viewport width */
      min-width: 100vw !important;
      padding: 0 !important;
      margin: 0 !important;
      display: flex !important;
      flex-direction: column !important;
      box-sizing: border-box !important;
    }
    
    .main-content {
      flex-direction: column !important;
      height: calc(100vh - 60px) !important;
      width: 100% !important; /* Ensure main content has full width */
      min-width: 100% !important; /* Force minimum width */
      padding: 0 !important;
      gap: 0 !important;
      margin: 0 !important;
      flex: 1 !important;
      display: flex !important;
      overflow: hidden !important;
      box-sizing: border-box !important;
    }
    
    /* Mobile video styling */
    .video-area {
      min-height: 250px !important;
      height: 50vh !important;
      max-height: 50vh !important;
      width: 100% !important; /* Ensure area has width */
      min-width: 320px !important; /* Force minimum width */
      flex: 1 !important; /* Take available space */
      position: relative !important;
    }
    
    #webinarVideo {
      width: 100% !important;
      height: 100% !important;
      min-height: 200px !important;
      min-width: 320px !important; /* Force minimum width */
      max-width: 100% !important;
      object-fit: contain !important;
      background: #000 !important;
      display: block !important; /* Ensure block display */
      box-sizing: border-box !important;
    }
    
    .video-container {
      min-height: 250px !important;
      height: 100% !important;
      width: 100% !important; /* Ensure container has width */
      min-width: 320px !important; /* Force minimum width */
      flex: 1 !important; /* Take available space */
      position: relative !important;
    }
    
    /* Control panel takes fixed space at bottom */
    .control-panel-redesign {
      position: relative !important;
      width: 100% !important;
      height: 60px !important;
      padding: 8px 12px !important;
      gap: 6px !important;
      border-radius: 0 !important;
      justify-content: center !important;
      border-top: 1px solid rgba(255, 255, 255, 0.08) !important;
      flex-shrink: 0 !important;
    }
    
    .video-area {
      height: 35vh !important;
      max-height: 35vh !important;
      min-height: 35vh !important;
      flex: none !important;
      margin: 0 !important;
      padding: 0 !important;
      position: relative !important;
      display: flex !important;
      flex-direction: column !important;
      overflow: hidden !important;
    }
    
    /* When chat is hidden, video area takes more space */
    .main-content.chat-hidden .video-area {
      height: calc(100vh - 60px) !important;
      max-height: calc(100vh - 60px) !important;
      min-height: calc(100vh - 60px) !important;
    }
    
    /* Remove all gaps from video content on mobile */
    .video-area > div {
      margin: 0 !important;
      padding: 0 !important;
      height: 100% !important;
      display: flex !important;
      align-items: center !important;
      justify-content: center !important;
    }
    
    .video-area .text-center {
      margin: 0 !important;
      padding: 10px !important;
    }
    
    .video-area .mb-4, .video-area .mb-2 {
      margin-bottom: 0 !important;
    }
    
    .video-area video {
      margin: 0 !important;
      padding: 0 !important;
      display: block !important;
      height: 100% !important;
      width: 100% !important;
    }
    
    .video-area .flex-1 {
      height: 100% !important;
      margin: 0 !important;
      padding: 0 !important;
    }
    
    /* Waiting state mobile overrides */
    .video-area .mb-6, .video-area .mb-4, .video-area .mb-2, .video-area .mt-6 {
      margin: 0 !important;
    }
    
    .video-area .bg-slate-800 {
      margin: 10px !important;
    }
    
    .video-area .max-w-md {
      max-width: 90% !important;
    }
    
    .chat-panel {
      width: 100% !important;
      height: calc(65vh - 60px) !important;
      max-height: calc(65vh - 60px) !important;
      min-height: calc(65vh - 60px) !important;
      border-left: none !important;
      border-top: 2px solid #3a3f4f !important;
      flex: none !important;
      margin: 0 !important;
      overflow-y: auto !important;
      position: relative !important;
      display: flex !important;
      flex-direction: column !important;
    }
    
    /* Ensure chat messages area is scrollable and input stays at bottom */
    .chat-panel .flex-1 {
      overflow-y: auto !important;
      min-height: 0 !important;
    }
    
    /* Fix chat input positioning on mobile */
    .chat-input {
      position: sticky !important;
      bottom: 0 !important;
      background: #1e293b !important;
      border-top: 1px solid #475569 !important;
      flex-shrink: 0 !important;
    }
    
    .floating-controls {
      bottom: 10px;
      left: 50%;
      transform: translateX(-50%);
      gap: 10px;
      padding: 8px 15px;
    }
    
    .control-button {
      width: 40px;
      height: 40px;
      font-size: 14px;
    }
    
    .ctrl-btn {
      width: 36px;
      height: 36px;
      font-size: 14px;
    }
    
    .live-badge {
      font-size: 10px;
      padding: 2px 4px;
      border-radius: 2px;
      border: 1px solid #ff4444;
      animation: live-blink 1.5s infinite;
    }
    
    .participant-count {
      font-size: 14px;
      padding: 6px 12px;
      border: 2px solid rgba(255, 255, 255, 0.3);
      background: rgba(255, 255, 255, 0.15);
    }
  }
  
  /* Extra small mobile screens */
  @media screen and (max-width: 480px) {
    .bottom-control-panel {
      padding: 6px 8px;
      min-height: 45px;
    }
    
    .control-button {
      width: 32px;
      height: 32px;
      font-size: 11px;
    }
    
    .status-left, .status-right {
      font-size: 10px;
    }
    
    .webinar-title {
      max-width: 60px;
      font-size: 9px;
    }
    
    .video-area {
      height: 35vh !important;
    }
    
    .chat-panel {
      height: 65vh !important;
    }
    
    .participant-info {
      top: 10px;
      left: 10px;
      padding: 8px 12px;
      font-size: 12px;
    }
    
    .status-indicator {
      top: 10px;
      right: 10px;
    }
  }
  
  /* Mobile landscape mode - desktop-like layout */
  @media screen and (max-width: 768px) and (orientation: landscape) {
    .webinar-room-content {
      flex-direction: column !important;
    }
    
    .main-content {
      flex-direction: row !important; /* Landscape: side-by-side like desktop */
      height: calc(100vh - 50px) !important; /* Leave space for control panel */
      overflow: hidden !important;
    }
    
    .video-area {
      height: 100% !important;
      max-height: 100% !important;
      min-height: 100% !important;
      width: 75% !important;
      flex: none !important;
      position: relative !important;
    }
    
    .chat-panel {
      width: 25% !important;
      height: 100% !important;
      max-height: 100% !important;
      min-height: 100% !important;
      border-left: 2px solid #3a3f4f !important;
      border-top: none !important;
      overflow-y: auto !important;
      box-sizing: border-box !important;
    }
    
    .control-panel-redesign {
      position: relative !important;
      bottom: 0 !important;
      left: 0 !important;
      right: 0 !important;
      width: 100% !important;
      max-width: 100% !important;
      height: 50px !important;
      z-index: 1000 !important;
      background: rgba(30, 30, 30, 0.95) !important;
      backdrop-filter: blur(10px) !important;
      border-top: 1px solid #3a3f4f !important;
      border-radius: 0 !important;
      overflow: hidden !important;
    }
    
    /* Hide host control panel in landscape mode to prevent conflicts */
    div[ng-include*="host-control-panel"] {
      display: none !important;
    }
    
    /* Landscape video container adjustments */
    .video-area > div {
      height: calc(100vh - 50px) !important;
      margin: 0 !important;
      padding: 0 !important;
    }
    
    /* Hide debug info in landscape mode to prevent blocking */
    .video-area .debug-info {
      display: none !important;
    }
    
    /* Adjust video element for landscape */
    #webinarVideo {
      height: calc(100vh - 50px) !important;
      width: 100% !important;
      object-fit: contain !important;
      min-height: 200px !important;
      min-width: 200px !important;
    }
    
    /* Hide send text in landscape mode */
    .landscape-hidden {
      display: none !important;
    }
    
    /* Smaller control buttons for landscape */
    .ctrl-btn {
      width: 35px !important;
      height: 35px !important;
      font-size: 12px !important;
    }
    
    .live-badge {
      font-size: 9px !important;
      padding: 1px 3px !important;
    }
    
    .participant-count {
      font-size: 11px !important;
      padding: 4px 8px !important;
    }
    
    /* Ensure participant count aligns properly in landscape */
    .control-panel-redesign .participant-count {
      align-self: center;
    }
  }
  
  @keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.7; }
  }
  
  @keyframes live-pulse {
    0%, 100% { opacity: 1; transform: scale(1); }
    50% { opacity: 0.8; transform: scale(1.1); }
  }
  
  .live-dot {
    animation: live-pulse 1.5s infinite ease-in-out;
  }
  
  @keyframes fade-in {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }
  
  .animate-fade-in {
    animation: fade-in 0.3s ease-out;
  }
</style>
